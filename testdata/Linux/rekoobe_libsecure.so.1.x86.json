{
    "Files": {
        "./Linux/rekoobe_libsecure.so.1.x86": {
            "Syscalls": [
                "accept",
                "connect",
                "execve",
                "fork",
                "posix_spawn",
                "pthread_create",
                "readlink",
                "recv",
                "select",
                "send",
                "setsockopt"
            ],
            "Pledge": [
                "exec",
                "inet",
                "rpath",
                "stdio"
            ],
            "Behaviors": {
                "3P/signature_base/backdoor/zipline": {
                    "Description": "This rule detects unique strings in ZIPLINE, a passive ELF backdoor that waits for incoming TCP connections to receive commands from the threat actor.",
                    "Strings": [
                        "$(exec $installer $@)",
                        "./installer/bom_files/",
                        "./installer/do-install",
                        "/tmp/data/root/etc/ld.so.preload",
                        "/tmp/data/root/home/etc/manifest/exclusion_list",
                        "SSH-2.0-OpenSSH_0.3xx"
                    ],
                    "RiskScore": 4,
                    "RiskLevel": "CRIT",
                    "RuleAuthor": "Mandiant",
                    "RuleLicense": "https://github.com/Neo23x0/signature-base/blob/cd7651d2ccf4158a35a8d1cc0441928f7d92818f/LICENSE"
                },
                "3P/signature_base/unc5221/ivanti": {
                    "Description": "Detects forensic artifacts found in the Ivanti VPN exploitation campaign by APT UNC5221",
                    "Strings": [
                        "sed -i '/retval=$(exec $installer $@)/d' /pkg/do-install"
                    ],
                    "RiskScore": 4,
                    "RiskLevel": "CRIT",
                    "RuleAuthor": "Florian Roth",
                    "RuleLicense": "https://github.com/Neo23x0/signature-base/blob/cd7651d2ccf4158a35a8d1cc0441928f7d92818f/LICENSE"
                },
                "combo/backdoor/generic/connect_execl_inet": {
                    "Description": "Listens, provides a terminal, runs program",
                    "Strings": [
                        "execl",
                        "inet_addr",
                        "socket"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/generic/progname_socket_exec": {
                    "Description": "Sets program name, accesses internet, calls programs",
                    "Strings": [
                        "__progname",
                        "socket",
                        "waitpid"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/generic/readdir_openpty_inet": {
                    "Description": "Lists directories, opens pseudoterminals, resolves IPs",
                    "Strings": [
                        "inet_addr",
                        "openpty",
                        "readdir"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/generic/readdir_system_inet": {
                    "Description": "Lists directories, resolves IPs, calls shells",
                    "Strings": [
                        "inet_addr",
                        "readdir",
                        "system"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/macos/dlsym_and_openpty": {
                    "Description": "Resolves library, opens terminal, calls shell",
                    "Strings": [
                        "dlsym",
                        "openpty",
                        "system"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/macos/dlsym_pthread_exec": {
                    "Description": "Resolves library, creates threads, calls programs",
                    "Strings": [
                        "dlsym",
                        "execl",
                        "pthread_create"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "dylib/address/check": {
                    "Description": "determine if address belongs to a shared library",
                    "Strings": [
                        "dladdr"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "dylib/symbol/address": {
                    "Description": "get the address of a symbol",
                    "Strings": [
                        "dlsym"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "evasion/fake/ssh_user_agent": {
                    "Description": "Contains OpenSSH user-agent, possibly for spoofing purposes",
                    "Strings": [
                        "SSH-2.0-OpenSSH_0.3xx"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "exec/program": {
                    "Description": "executes another program",
                    "Strings": [
                        "execl"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "exec/program/background": {
                    "Description": "Waits for a process to exit",
                    "Strings": [
                        "waitpid"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "exec/shell_command": {
                    "Description": "execute a shell command",
                    "Strings": [
                        "system"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "exec/shell_echo": {
                    "Description": "uses the echo command to generate output",
                    "Strings": [
                        "echo '%s' \u003e\u003e ./installer/bom_files/%s",
                        "echo '%s' \u003e\u003e /tmp/data/root/home/etc/manifest/exclusion_list"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "fd/multiplex": {
                    "Description": "monitor multiple file descriptors",
                    "Strings": [
                        "select"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "fs/file/create": {
                    "Description": "create a new file or rewrite an existing one",
                    "Strings": [
                        "creat"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "fs/link/read": {
                    "Description": "read value of a symbolic link",
                    "Strings": [
                        "readlink"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/hostport/parse": {
                    "Description": "Network address and service translation",
                    "Strings": [
                        "freeaddrinfo",
                        "getaddrinfo"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/ip/parse": {
                    "Description": "Parse an IP address (IPv4 or IPv6)",
                    "Strings": [
                        "inet_addr"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/ip/string": {
                    "Description": "converts IP address from byte to string",
                    "Strings": [
                        "inet_ntoa"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/socket/connect": {
                    "Description": "initiate a connection on a socket",
                    "Strings": [
                        "connect"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/listen": {
                    "Description": "listen on a socket",
                    "Strings": [
                        "accept",
                        "listen",
                        "socket"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/receive": {
                    "Description": "receive a message to a socket",
                    "Strings": [
                        "recv",
                        "socket"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/send": {
                    "Description": "send a message to a socket",
                    "Strings": [
                        "send",
                        "socket"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/tunnel": {
                    "Description": "Creates a network tunnel",
                    "Strings": [
                        "inet_addr",
                        "tunnel"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "process/create": {
                    "Description": "Create a new child process using fork",
                    "Strings": [
                        "fork"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "process/current/alarm": {
                    "Description": "set an alarm clock for delivery of a signal",
                    "Strings": [
                        "alarm"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "process/current/name/get": {
                    "Description": "get the current programs name",
                    "Strings": [
                        "program_invocation_short_name"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "process/current/name/set": {
                    "Description": "get or set the programs name",
                    "Strings": [
                        "__progname"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "process/thread/create": {
                    "Description": "create a new thread",
                    "Strings": [
                        "pthread_create"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "procfs/self_cmdline": {
                    "Description": "Gets the command-line associated to this process",
                    "Strings": [
                        "/proc/self/cmdline"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "procfs/self_exe": {
                    "Description": "Gets the file associated to this process",
                    "Strings": [
                        "/proc/self/exe"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "ref/path/etc": {
                    "Description": "References paths within /etc",
                    "Strings": [
                        "/etc/ld.so.preload",
                        "/etc/manifest/exclusion"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "ref/path/etc/ld.so.preload": {
                    "Description": "References /etc/ld.so.preload",
                    "Strings": [
                        "/etc/ld.so.preload"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "ref/path/home": {
                    "Description": "References paths within /home",
                    "Strings": [
                        "/home/etc/manifest/exclusion_list",
                        "/home/lib",
                        "/home/lib/%s"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "ref/path/lib/dynamic": {
                    "Description": "References a library file that can be generated dynamically",
                    "Strings": [
                        "/lib/%s"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "ref/path/root": {
                    "Description": "References paths within /root",
                    "Strings": [
                        "/root",
                        "/root/etc/ld.so.preload",
                        "/root/home/etc/manifest/exclusion_list",
                        "/root/home/lib",
                        "/root/home/lib/%s"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "ref/path/tmp": {
                    "Description": "References paths within /tmp",
                    "Strings": [
                        "/tmp/data/root/etc/ld.so.preload",
                        "/tmp/data/root/home/etc/manifest/exclusion_list",
                        "/tmp/data/root/home/lib",
                        "/tmp/data/root/home/lib/%s"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "tty/open": {
                    "Description": "finds and opens an available pseudoterminal",
                    "Strings": [
                        "openpty"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "tty/pathname": {
                    "Description": "returns the pathname of a terminal device",
                    "Strings": [
                        "ttyname"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                }
            }
        }
    }
}
