{
    "Files": {
        "./Linux/bpfdoor_2022.x86_64": {
            "Syscalls": [
                "accept",
                "chroot",
                "connect",
                "execve",
                "fork",
                "select",
                "sendmsg",
                "sendto",
                "unlink",
                "utimes",
                "vhangup"
            ],
            "Pledge": [
                "exec",
                "fattr",
                "inet",
                "stdio",
                "wpath"
            ],
            "Behaviors": {
                "3P/elastic/linux/bpfdoor": {
                    "Description": "Detects Linux Trojan Bpfdoor (Linux.Trojan.BPFDoor)",
                    "Strings": [
                        "$a1"
                    ],
                    "RiskScore": 4,
                    "RiskLevel": "CRIT",
                    "RuleAuthor": "Elastic Security",
                    "RuleLicense": "https://github.com/elastic/protections-artifacts//blob/6d54ae289b290b1d42a7717569483f6ce907200a/LICENSE.txt"
                },
                "3P/signature_base/redmenshen/bpfdoor": {
                    "Description": "Detects BPFDoor implants used by Chinese actor Red Menshen",
                    "Strings": [
                        "$op1",
                        "$op2",
                        "$op3",
                        "$op4"
                    ],
                    "RiskScore": 4,
                    "RiskLevel": "CRIT",
                    "RuleAuthor": "Florian Roth (Nextron Systems)",
                    "RuleLicense": "https://github.com/Neo23x0/signature-base/blob/cd7651d2ccf4158a35a8d1cc0441928f7d92818f/LICENSE"
                },
                "combo/backdoor/linux/listen_terminal_exec": {
                    "Description": "Listens, provides a terminal, runs program",
                    "Strings": [
                        "/dev/ptmx",
                        "execve",
                        "grantpt",
                        "listen"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "combo/backdoor/linux/multiple_sys_commands": {
                    "Description": "multiple sys commands",
                    "Strings": [
                        "auditd",
                        "systemd/systemd"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "device/pseudo_terminal": {
                    "Description": "pseudo-terminal access functions",
                    "Strings": [
                        "grantpt",
                        "ptsname",
                        "unlockpt"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "exec/program": {
                    "Description": "executes another program",
                    "Strings": [
                        "execve"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "exec/program/background": {
                    "Description": "Waits for a process to exit",
                    "Strings": [
                        "waitpid"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "exec/shell_command": {
                    "Description": "execute a shell command",
                    "Strings": [
                        "system"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "fd/multiplex": {
                    "Description": "monitor multiple file descriptors",
                    "Strings": [
                        "select"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "fs/file/delete": {
                    "Description": "deletes files",
                    "Strings": [
                        "unlink"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "fs/file/times/set": {
                    "Description": "change file last access and modification times",
                    "Strings": [
                        "utimes"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/ip/byte/order": {
                    "Description": "convert values between host and network byte order",
                    "Strings": [
                        "htons"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/ip/string": {
                    "Description": "converts IP address from byte to string",
                    "Strings": [
                        "inet_ntoa"
                    ],
                    "RiskScore": 2,
                    "RiskLevel": "MED"
                },
                "net/socket/connect": {
                    "Description": "initiate a connection on a socket",
                    "Strings": [
                        "connect"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/listen": {
                    "Description": "listen on a socket",
                    "Strings": [
                        "accept",
                        "listen",
                        "socket"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/receive": {
                    "Description": "receive a message from a socket",
                    "Strings": [
                        "recvfrom"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "net/socket/send": {
                    "Description": "send a message to a socket",
                    "Strings": [
                        "sendto"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "process/create": {
                    "Description": "Create a new child process using fork",
                    "Strings": [
                        "fork"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "process/current/chroot": {
                    "Description": "change the location of root for the process",
                    "Strings": [
                        "chroot"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "random/insecure": {
                    "Description": "generate random numbers insecurely",
                    "Strings": [
                        "srand"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "ref/path/usr/sbin": {
                    "Description": "References paths within /usr/sbin",
                    "Strings": [
                        "/usr/sbin/console-kit-daemon"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                },
                "ref/program/ancient_gcc": {
                    "Description": "built by archaic gcc version",
                    "Strings": [
                        "GCC: (GNU) 4.4.7"
                    ],
                    "RiskScore": 3,
                    "RiskLevel": "HIGH"
                },
                "tty/vhangup": {
                    "Description": "virtually hangup the current terminal",
                    "Strings": [
                        "vhangup"
                    ],
                    "RiskScore": 1,
                    "RiskLevel": "LOW"
                }
            }
        }
    }
}
