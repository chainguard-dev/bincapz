rule possible_container_breakout : suspicious {
  strings:
    $docker_sock = "docker.sock"
    $map_root_to_mnt = "/:/mnt"
    $docker_mount_root = /docker run[ \w\-]* -v \/:/
    $cp_bin_bash = "cp /bin/bash"
    $fdisk_grep = "fdisk -l | grep"
    $proc1_status = "/proc/1/status"
    $capsh_print = "capsh --print"
    $capsysadmin = "CAP_SYS_ADMIN"
    $notify_on_release = "notify_on_release"
    $apparmor = "/sys/kernel/security/apparmor"
    $mount_cgroup = "mount -t cgroup"
    $rdma_cgroup = "rdma cgroup"
    $cgroup_procs = "cgroup.procs"
  condition:
    2 of them
}