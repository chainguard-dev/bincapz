
rule router_malware : critical {
  meta:
    description = "access paths seen in router malware"
  strings:
    $f_bin_busybox = "/bin/busybox"
    $f_usr_sbin = "/usr/sbin"
    $f_admin_console = "/var/www/cgi-bin/admin_console_core.cgi"
    $f_telnetd = "telnetd"
    $f_httpd = "/usr/bin/httpd"
    $f_upnp = "/dev/upnp"
    $f_ipcam_app = "/usr/share/ipcam/app"
    $f_ping_test = "/opt/www/cgi-bin/ping_test.cgi"
    $f_usr_bin_ps = "/usr/bin/ps"
    $f_wget = "/wget"
    $f_curl = "/curl"
    $not_dos2unix = "/usr/bin/dos2unix"
    $not_setfont = "/usr/sbin/setfont"
  condition:
    5 of ($f*) and none of ($not*)
}
