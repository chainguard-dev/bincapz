## Changed: .

### 20 new behaviors

|   RISK    |                                                                                           KEY                                                                                           |                                                                                                       DESCRIPTION                                                                                                       |                                                                                                                               EVIDENCE                                                                                                                               |
|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| +CRITICAL | **[3P/signature_base/3cxdesktopapp/backdoor](https://github.com/Neo23x0/signature-base/blob/1b9069ac3d8d5b6dd2b61d3c934bf19b70323011/yara/gen_mal_3cx_compromise_mar23.yar#L251-L275)** | [Detects 3CXDesktopApp MacOS Backdoor component](https://www.volexity.com/blog/2023/03/30/3cx-supply-chain-compromise-leads-to-iconic-incident/), by X__Junior (Nextron Systems)                                        | $op1<br>$op2<br>[%s/.main_storage](https://github.com/search?q=%25s%2F.main_storage&type=code)<br>[%s/UpdateAgent](https://github.com/search?q=%25s%2FUpdateAgent&type=code)                                                                                         |
| +CRITICAL | **[3P/signature_base/nk/3cx](https://github.com/Neo23x0/signature-base/blob/1b9069ac3d8d5b6dd2b61d3c934bf19b70323011/yara/gen_mal_3cx_compromise_mar23.yar#L188-L214)**                 | [Detects malicious DYLIB files related to 3CX compromise](https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/), by Florian Roth (Nextron Systems) | $xc1<br>$xc2<br>$xc3                                                                                                                                                                                                                                                 |
| +CRITICAL | **[3P/signature_base/susp/xored](https://github.com/Neo23x0/signature-base/blob/1b9069ac3d8d5b6dd2b61d3c934bf19b70323011/yara/gen_xor_hunting.yar#L2-L20)**                             | [Detects suspicious single byte XORed keyword 'Mozilla/5.0' - it uses yara's XOR modifier and therefore cannot print the XOR key](https://gchq.github.io/CyberChef/#recipe=XOR_Brute_Force()), by Florian Roth          | $xo1                                                                                                                                                                                                                                                                 |
| +CRITICAL | **[3P/volexity/iconic](https://github.com/volexity/threat-intel/blob/62e031ea574efde68dac7d38dc23438466a5302b/2023/2023-03-30%203CX/indicators/rules.yar#L32-L50)**                     | [Detects the MACOS version of the ICONIC loader.](https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/), by threatintel@volexity.com                                       | $str1<br>$str2<br>$str3                                                                                                                                                                                                                                              |
| +CRITICAL | **[evasion/xor/user_agent](https://github.com/chainguard-dev/bincapz/blob/main/rules/evasion/xor-user_agent.yara#xor_mozilla)**                                                         | XOR'ed user agent, often found in backdoors, by Florian Roth                                                                                                                                                            | $Mozilla_5_0                                                                                                                                                                                                                                                         |
| +MEDIUM   | **[exec/pipe](https://github.com/chainguard-dev/bincapz/blob/main/rules/exec/pipe.yara#popen)**                                                                                         | [launches program and reads its output](https://linux.die.net/man/3/popen)                                                                                                                                              | [_pclose](https://github.com/search?q=_pclose&type=code)<br>[_popen](https://github.com/search?q=_popen&type=code)                                                                                                                                                   |
| +MEDIUM   | **[fs/permission/modify](https://github.com/chainguard-dev/bincapz/blob/main/rules/fs/permission-modify.yara#chmod)**                                                                   | [modifies file permissions](https://linux.die.net/man/1/chmod)                                                                                                                                                          | [chmod](https://github.com/search?q=chmod&type=code)                                                                                                                                                                                                                 |
| +MEDIUM   | **[net/http/cookies](https://github.com/chainguard-dev/bincapz/blob/main/rules/net/http-cookies.yara#http_cookie)**                                                                     | [access HTTP resources using cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)                                                                                                                        | [Cookie](https://github.com/search?q=Cookie&type=code)<br>[HTTP](https://github.com/search?q=HTTP&type=code)                                                                                                                                                         |
| +MEDIUM   | **[net/url/request](https://github.com/chainguard-dev/bincapz/blob/main/rules/net/url-request.yara#requests_urls)**                                                                     | requests resources via URL                                                                                                                                                                                              | [NSMutableURLRequest](https://github.com/search?q=NSMutableURLRequest&type=code)                                                                                                                                                                                     |
| +MEDIUM   | **[ref/path/hidden](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/path/hidden.yara#dynamic_hidden_path)**                                                               | [hidden path generated dynamically](https://objective-see.org/blog/blog_0x73.html)                                                                                                                                      | [%s/.main_storage](https://github.com/search?q=%25s%2F.main_storage&type=code)                                                                                                                                                                                       |
| +MEDIUM   | **[shell/arbitrary_command/dev_null](https://github.com/chainguard-dev/bincapz/blob/main/rules/shell/arbitrary_command-dev_null.yara#cmd_dev_null)**                                    | runs commands, discards output                                                                                                                                                                                          | ["%s" >/dev/null](https://github.com/search?q=%22%25s%22+%3E%2Fdev%2Fnull&type=code)                                                                                                                                                                                 |
| +LOW      | **[compression/gzip](https://github.com/chainguard-dev/bincapz/blob/main/rules/compression/gzip.yara#gzip)**                                                                            | [works with gzip files](https://www.gnu.org/software/gzip/)                                                                                                                                                             | [gzip](https://github.com/search?q=gzip&type=code)                                                                                                                                                                                                                   |
| +LOW      | **[env/HOME](https://github.com/chainguard-dev/bincapz/blob/main/rules/env/HOME.yara#HOME)**                                                                                            | [Looks up the HOME directory for the current user](https://man.openbsd.org/login.1#ENVIRONMENT)                                                                                                                         | [HOME](https://github.com/search?q=HOME&type=code)<br>[getenv](https://github.com/search?q=getenv&type=code)                                                                                                                                                         |
| +LOW      | **[fs/lock/update](https://github.com/chainguard-dev/bincapz/blob/main/rules/fs/lock-update.yara#flock)**                                                                               | apply or remove an advisory lock on a file                                                                                                                                                                              | [flock](https://github.com/search?q=flock&type=code)                                                                                                                                                                                                                 |
| +LOW      | **[kernel/dispatch/semaphore](https://github.com/chainguard-dev/bincapz/blob/main/rules/kernel/dispatch-semaphore.yara#dispatch_sem)**                                                  | [Uses Dispatch Semaphores](https://developer.apple.com/documentation/dispatch/dispatch_semaphore)                                                                                                                       | [dispatch_semaphore_signal](https://github.com/search?q=dispatch_semaphore_signal&type=code)                                                                                                                                                                         |
| +LOW      | **[kernel/hostname/get](https://github.com/chainguard-dev/bincapz/blob/main/rules/kernel/hostname-get.yara#gethostname)**                                                               | [get computer host name](https://man7.org/linux/man-pages/man2/sethostname.2.html)                                                                                                                                      | [gethostname](https://github.com/search?q=gethostname&type=code)                                                                                                                                                                                                     |
| +LOW      | **[net/http/accept/encoding](https://github.com/chainguard-dev/bincapz/blob/main/rules/net/http-accept-encoding.yara#content_type)**                                                    | [set HTTP response encoding format (example: gzip)](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding)                                                                                          | [Accept-Encoding](https://github.com/search?q=Accept-Encoding&type=code)                                                                                                                                                                                             |
| +LOW      | **[random/insecure](https://github.com/chainguard-dev/bincapz/blob/main/rules/random/insecure.yara#bsd_rand)**                                                                          | [generate random numbers insecurely](https://man.openbsd.org/rand)                                                                                                                                                      | [_rand](https://github.com/search?q=_rand&type=code)<br>[srand](https://github.com/search?q=srand&type=code)                                                                                                                                                         |
| +LOW      | **[ref/path/home_library](https://github.com/chainguard-dev/bincapz/blob/main/rules/ref/path/home_library.yara#home_lib_path)**                                                         | path reference within ~/Library                                                                                                                                                                                         | [/System/Library/Frameworks/CoreFoundation](https://github.com/search?q=%2FSystem%2FLibrary%2FFrameworks%2FCoreFoundation&type=code)<br>[/System/Library/Frameworks/Foundation](https://github.com/search?q=%2FSystem%2FLibrary%2FFrameworks%2FFoundation&type=code) |
| +LOW      | **[sync/semaphore/user](https://github.com/chainguard-dev/bincapz/blob/main/rules/sync/semaphore-user.yara#semaphore_user)**                                                            | uses semaphores to synchronize data between processes or threads                                                                                                                                                        | [semaphore_create](https://github.com/search?q=semaphore_create&type=code)<br>[semaphore_signal](https://github.com/search?q=semaphore_signal&type=code)<br>[semaphore_wait](https://github.com/search?q=semaphore_wait&type=code)                                   |

